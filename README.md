# -Tilt_compensated_compass_ATmega328P
     for boat autopilot (see <https://github.com/Aleksk1/Boat_autopilot_MMBasic>)
________________________________________________________________________________

 Основой многих автопиловтов являетя компас. 
Как правило на подвижных транспортных средствах компас сделан так, что показывает правильный азимут не зависимо от наклона.
На лодах, и особенно  парусных яхтах, это важно, т.к. парусная лодка часто идет со значительным креном.
 Компас будем строить на  датчиках, трехосном магнитометре HMC5883L и трехосном акселерометре MPU6050.
В идеальном случае, когда  идеальный магнитометер расположен строго горизонтально, то при вращении в этой плоскости, вектор магнитных компонент (X,Y)  в прямоугольной системе координат, нарисует окружность. При отклонении от горизонтальной плоскости , окружность будет искажаться. Ситуация будет тем хуже чем дальше мы находимся от экватора (в высоких широтах линии магнитного поля входят в поверхность Земли под большими углами, в то время как на экваторе линии параллелны плоскости горизонта).  При этом центр окружности будет смещаться от начала координат. Все это приводит к недопустимым погрешностям определения азимута.
 Раньше с этим боролись, помещая магнитометр в карданов подвес, именно с ним я отходил первый сезон на автопилоте.
У такого устройства довольно много недостатков,
1.  - громоздскость, тяжесть и сложность механической конструкции подвеса
2.  - собственные колебания с высокой добротностью, которые надо гасить.
3.  - демпфироание осуществляось силиконовым маслом, поэтому нужен дорогой герметичный корпус.
4.  - был выбран неудачный магнитометр с сильными шумами и высокой зависимостью от температуры.
<Photos/magnetometr_MAG3110.jpg>
<Photos/magnetometr_MAG3110_screen.jpg>
 

Поэтому было принято решение сделать чисто электронный вариант на более подходящем магнитометре без подвижных элементов конструкции.